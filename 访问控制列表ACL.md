# 访问控制列表
  * 访问控制列表(Access Control List，简称ACL)是根据报文字段对报文进行过滤的一种安全技术。
  * 访问控制列表通过过滤报文达到流量控制、攻击防范以及用户接入控制等功能，在现实中应用广泛。
  * ACL根据功能的不同分为标准ACL和扩展ACL。标准ACL只能过滤报文的源IP地址；扩展ACL可以过滤源IP、目的IP、协议类型、端口号等。
  * ACL的配置主要分为两个步骤：（1）根据需求编写ACL；(2)将ACL应用到路由器接口的某个方向。
  
## 什么是访问控制列表
  1. 访问控制列表（Access Control List）是一种路由器配置脚本，它根据从数据包报头中发现的条件来控制路由器应该允许还是拒绝数据包通过。
  2. 通过接入控制列表可以在路由器、三层交换机上进行网络安全属性配置，可以实现对进入路由器、三层交换机的输入数据流进行过滤，但ACL 对路由器自身产生的数据包不起作用。
  3. 当每个数据包经过关联有 ACL 的接口时，都会与 ACL 中的语句从上到下一行一行进行比对，以便发现符合该传入数据包的模式。
  4. ACL 使用允许或拒绝规则来决定数据包的命运，通过此方式来贯彻一条或多条公司安全策略。还可以配置 ACL 来控制对网络或子网的访问。也可以在VTY线路接口上使用访问控制列表，来保证telnet的连接的安全性。
  5. 默认情况下，路由器上没有配置任何 ACL，不会过滤流量。进入路由器的流量根据路由表进行路由。如果路由器上没有使用 ACL，所有可以被路由器路由的数据包都会经过路由器到达下一个网段。ACL 主要执行以下任务：
      * 限制网络流量以提高网络性能。例如，如果公司政策不允许在网络中传输视频流量，那么就应该配置和应用 ACL 以阻止视频流量。这可以显著降低网络负载并提高网络性能。
      * 提供流量控制。ACL 可以限制路由更新的传输。如果网络状况不需要更新，便可从中节约带宽。
      * 提供基本的网络访问安全性。ACL 可以允许一台主机访问部分网络，同时阻止其它主机访问同一区域。例如，“人力资源”网络仅限选定用户进行访问。
      * 决定在路由器接口上转发或阻止哪些类型的流量。例如，ACL 可以允许电子邮件流量，但阻止所有 Telnet 流量。
      * 控制客户端可以访问网络中的哪些区域。
      * 屏蔽主机以允许或拒绝对网络服务的访问。ACL 可以允许或拒绝用户访问特定文件类型，例如 FTP 或 HTTP。
      
## 访问控制列表的分类
  * ACL的类型主要分为IP标准访问控制列表（Standard IP ACL）和IP扩展访问控制列表（Extended IP ACL）两大类：
    * IP标准访问控制列表（Standard IP ACL）。标准 ACL 根据源 IP 地址允许或拒绝流量。数据包中包含的目的地址和端口无关紧要。   
    * IP扩展访问控制列表（Extended IP ACL ）。扩展 ACL 根据多种属性（例如，协议类型、源和 IP 地址、目的 IP 地址、源 TCP 或 UDP 端口、目的 TCP 或 UDP 端口）过滤 IP 数据包，并可依据协议类型信息（可选）进行更为精确的控制。
  * 此外还包括一些复杂的ACL,例如命名ACL，基于时间的ACL,动态ACL,自反ACL等。
  
## ACL工作原理
  * ACL 要么配置用于入站流量，要么用于出站流量。
    * 入站 ACL 传入数据包经过处理之后才会被路由到出站接口。
    * 入站 ACL 非常高效，如果数据包被丢弃，则节省了执行路由查找的开销。当测试表明应允许该数据包后，路由器才会处理路由工作。
        * 如果数据包报头与某条 ACL 语句匹配，则会跳过列表中的其它语句，由匹配的语句决定是允许还是拒绝该数据包。
        * 如果数据包报头与 ACL 语句不匹配，那么将使用列表中的下一条语句测试数据包。此匹配过程会一直继续，直到抵达列表末尾。
        * 最后一条隐含的语句适用于不满足之前任何条件的所有数据包。这条最后的测试条件与这些数据包匹配，并会发出“拒绝”指令。此时路由器不会让这些数据进入或送出接口，而是直接丢弃它们。
        * 最后这条语句通常称为“隐式 deny any 语句”或“拒绝所有流量”语句。由于该语句的存在，所以 ACL 中应该至少包含一条 permit 语句，否则 ACL 将阻止所有流量。
    * 出站 ACL 传入数据包路由到出站接口后，由出站 ACL 进行处理。
        * 在数据包转发到出站接口之前，路由器检查路由表以查看是否可以路由该数据包。
        * 如果该数据包不可路由，则丢弃它。接下来，路由器检查出站接口是否配置有 ACL。如果出站接口没有配置 ACL，那么数据包可以发送到输出缓冲区。
    
## 3P原则
   * 在路由器上应用 ACL 的一般规则我们简称为3P原则。即我们可以为每种协议 (per protocol)、每个方向 (per direction)、每个接口 (per interface) 配置一个 ACL：
      * 每种协议一个 ACL： 要控制接口上的流量，必须为接口上启用的每种协议定义相应的 ACL。
      * 每个方向一个 ACL：一个 ACL 只能控制接口上一个方向的流量。要控制入站流量和出站流量，必须分别定义两个 ACL。
      * 每个接口一个 ACL：一个 ACL 只能控制一个接口（例如快速以太网 0/0）上的流量。
      
## ACL的放置位置
  * 每一个路由器接口的每一个方向，每一种协议只能创建一个ACL；在适当的位置放置 ACL 可以过滤掉不必要的流量，使网络更加高效。
  * ACL 可以充当防火墙来过滤数据包并去除不必要的流量。ACL 的放置位置决定了是否能有效减少不必要的流量。例如，会被远程目的地拒绝的流量不应该消耗通往该目的地的路径上的网络资源。
  * 每个 ACL 都应该放置在最能发挥作用的位置。基本的规则是：
      1. 将扩展 ACL 尽可能靠近要拒绝流量的源。这样，才能在不需要的流量流经网络之前将其过滤掉。
      2. 因为标准 ACL 不会指定目的地址，所以其位置应该尽可能靠近目的地。
    
