
基于RFC2544的网络测试仪的设计和实现

					基于ASIC芯片的网络测试仪的设计和实现
1.	选题目的和意义：
无线通信测试技术与测试仪器是通信产业的重要支撑力量，它渗透于通信芯片、模块、终端、基站、无线网络等几乎所有的产业链环节，贯穿于设计研发、认证验收、生产、网络建设与优化等几乎完整产业生命周期。目前国内以太网测试仪表市场主要被国外的仪表占据，测试功能不够完善，价格昂贵；而国内自主研发的仪表又缺乏稳定性和可靠性。因此芯片定制测试仪具有广阔的研究价值和市场前景。
2.	国内外网络测试仪的发展和现状
1、国外测试仪表的发展和现状
因为网络在国外已经非常普及，所以国外网络测试方面的产品增长的也非常快。除了一些知名的仪表制造厂家推出系列化的仪表外，很多其它公司也加入这一领域。他们的数据通信仪表不仅类型齐全，而且功能强大。如CTC的 HCT6000，FLUKE的One Touch、FLUKE68X等以及HP、WG、T1℃等老牌仪表商的优秀产品。它们占据了测试仪器市场的主要部分。国外测试仪器一般硬件水平高，采用专用集成电路芯片，减少硬件复杂程度和体积，并增加了可靠性， 有的公司采用TDSP芯片作处理器，可以完成复杂数据的处理，仪器功能多，可适应多种传输测试的需要。
2、国内测试仪表的发展和现状
在国内最常用的几款测试仪表据来自于欧美国家。目前，市场上比较流行的是安捷伦公司生产的FrameScopePro千兆以太网测试仪，RFC2544性能测试仪，JDSU的SMARTCLASS千兆以太网测试仪等，国内的主要由山东信通，柳州达迪等公司生产的仪表。但是国内的这款仪表从性能上来说都无法与前面两款相比较，在处理大规模数据时，缺乏稳定性与可靠性，长远看来，无法满足市场对网络测试仪功能日益增长的需求。目前国内测试仪表存在以下问题：
	商用仪表涉A，商业使用受到极大限制
	测试仪表的需求量多，使用成本高
	自研Tesgine3.0不支持GE接口，Tesgine2.0面临停产
	现有主用测试仪表不能满足如以太接口的半双工功能、帧抢占、超短帧等测试需求

3.	论文主要工作与结构安排
参照国内外网络测试系统的功能以及本身的设备资源情况，主要工作内容包括以下几个方面：
（１）简要介绍了以太网相关的基础知识，详细叙述了以太网各种基本协议与评价网络设备性能的ＲＦＣ２５４４测试标准
（２）对所需设计的网络性能测试仪功能需求及性能指标进行分析，给出了一种新型的基于上位机控制软件／嵌入式处理器／高性能逻辑器件架构的网络性能测试系统总方案，并对各部分功能模块分别进行设计，给出设计方案。
（３）	重点叙述了基于网络性能测试仪总方案的ＲＦＣ２５４４测试标准功能设计与实首先，分析了ＲFＣ２５４４测试标准中吞吐量、丢包率、时延、背靠背这四个测试功能的需求及性能指标；其次，根据性能指标，给出ＲＦＣ２５４４测试标准功能设计总方案，分别对该方案中的功能算法与软件模块进设计；最后，采用模块化的方式，利用Ｐｙｔｈｏｎ语言对设计算法及功能进行实现。ＲＦＣ２５４４测试标准功能实现方案主要由：ＲＦＣ２５４４测试用户界面模块、ＲＦＣ２５４４测试管控模块、ＲＦＣ２５４４测试功能算法模块、报文命令构造模块组成。
（４）对所设计的网络性能测试仪ＲＦＣ２５４４测试功能进行实验验证，经过不断测试与验证，得到测试结果，并对结果进行分析论证。
3、本文结构安排如下：
第一章：简要阐述了课题研宄背景和意义，介绍了网络性能测试仪国内外发展现状，对本文的主要工作和创新点进行了简要叙述，并阐述了本文结构安排。
第二章：主要对以太网相关基础知识以及各类以太网协议进行介绍，为下面整个方案设计论证打好基础。
第三章：主要论证了网络性能测试仪总体设计方案。分别对方案中硬件、现场可
编程门阵列（ＦｉｅｌｄＰｒｏｇｒａｍｍａｂｌｅＧａｔｅＡｒｒａｙ，ＦＰＧＡ）、嵌入式ＰｏｗｅｒＰＣ处理器ＰｅｒｆｏｒｍａｎｃｅＯｐｔｉｍｉｚａｔｉｏｎＷｉｔｈＥｎｈａｎｃｅｄＲＩＳＣ＿ＰｅｒｆｏｒｍａｎｃｅＣｏｍｐｕｔｉｎｇ，ＰＰＣ）以及上位机软件部分进行分析。
第四章：完成了基于网络性能测试仪总方案的ＲＦＣ２５４４测试标准测试功能的设计与实现，详细叙述了设计方案、设计算法流程与功能实现过程。
第五章：主要对网络性能测试仪ＲＦＣ２５４４测试标准功能进行测试与验证，给出测试过程与结果，最终得到验证结论。

4.	测试仪功能实现中的设计要点
3.1 高速流量的生成与处理
在高速网络的情况下，测试端口的数据流生成和统计往往要求系统具备非常高的处理速度。对于高速测试端口，CPU处理能力有限，测试端口的网络数据流量产生和实时的统计，均需要专门的硬件支持，比如使用FPGA  ASIC  NP(可同时作为CPU单元)来实现。引入目的就是在硬件层面解决高速流量的问题，它专门负责用于测试高速端口的数据流的实时生成与统计。流数据引擎和网络测试端口组成一个功能独立的模块，物理上来说，它既可以和执行处理器做在一起，也可以相互独立。如果独立的话，那么测试仪的端口扩展性将会大大提高;但是，测试端口之间的同步实现会变得较为复杂。流数据引擎的功能结构包括发送部分与接收部分，如图所示。



发送模块主要负责产生测试所需的流数据、完成协议控制数据的发送。其中协议控制数据的发送要求实时性和优先性，即需要中断测试流数据的发送。对于测试流数据的生成，要有流模型的产生、流调度，而且这些操作不能影响数据的线速发送。接收模块主要完成测试流数据的接收与统计、协议控制数据的接收。协议控制数据需要优先转发到系统处理。在测试流数据的处理中，需要进行简单的统计工作，如接收到总的字节数、总的包数等;而对于满足捕获条件的流数据则需要存储起来，转发给系统作进一步分析。接收模块要求对线速流数据的统计与捕获的实时性。
3.2 软件设计方案
软件设计方案由两大模块组成:基础功能模块与功能测试模块。
    基础功能模块主要完成了表3.2中1-S上位机软件功能基本需求，通过用户界面模块、通信协议模块、配置管理模块、命令处理模块、报文构造模块以及公共库模块实现。用户界面模块由报文构造设置界面、速率动态显示界面、抓取报文包界面与功能测试界面构成。用户可以在报文构造设置界面对测试报文进行配置，报文构造模块会根据用户配置参数对测试报文命令进行构造。通信协议模块保证了上位机与下位机的高效通信。公共库模块主要对各模块的通用部分进行了设计与定义，保证了实现代码的精简性。
    功能测试模块主要基于三个评测网络互联设备的国际标准:RFC2544, RFC2889,RFC3918，对这三个标准相关测试功能进行设计实现。由于模块化的程序设计可以高效地完成开发任务，本测试仪上位机方案采用插件的形式实现上述三个标准测试功能。在网络性能测试仪基础功能模块的开发基础上，将RFC2544, RFC2889, RFC3918测试功能作为单独功能模块进行设计实现。分别对这三个标准测试模块的用户界面、功能测试算法、功能测试结果进行设计与实现。在实现的过程中，需要调用基础功能模块，完成构造相应的测试报文命令。通过解析计算下位机回送报文内容，将功能测试‘结果显示在用户界面上。

5 研究创新点
	解决了华为内部主用测试仪Tesgine无法满足半双工功能，超短帧等功能的测试需求 
	



    论文主要完成了网络性能测试仪中RFC2544测试标准协议的设计与实现。首先，介绍了网络通信协议及用于评测网络互连设备性能的RFC2544测试标准;其次，分析了网络性能测试仪功能需求与性能指标，根据该指标提出了一种基于上位机/嵌入式处理器/高性能逻辑器件的新型网络性能测试系统方案；然后，基于网络性能测试系统总方案，对RFC2544测试标准的算法方案与上位机软件方案进行设计，并通过Python语言实现;最后，对所设计的网络性能测试仪RFC2544功能进行实验验证与测试应用。



参考文献：
李光永．网络性能测试仪设计方法的分析与研宄
朱熠良 基于FPGA的可编程精确网络报文构造和发送单元的设计与实现
马尼拉 IP网络测量仪网络设备测试方法研究与实现
陈悦 基于RFC2544的网络性能测试仪
